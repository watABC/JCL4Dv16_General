//JCL_tbl_GetPtr_byName//20130119 wat//テーブル名からポインタを返す//JCL_tbl_GetPtr_byName//20111103 wat//テーブルポインタを取得////C_TEXT($1;$inTableName)//$inTableName:=$1//テーブル名//C_POINTER($2;$outTablePtrPtr)//$outTablePtrPtr:=$2//テーブルポインタ//C_TEXT($0;$outTblNameStr)//テーブル//$outTblNameStr:=""//C_LONGINT($numOfTables;$i)//C_TEXT($table_name)////CLEAR VARIABLE($outTablePtrPtr)////$numOfTables:=Get last table number////For ($i;1;$numOfTables)////If (Is table number valid($i)=True)////$table_name:=Table name($i)//If ($inTableName=$table_name)//////名前が一致//$outTablePtrPtr->:=Table($i)//$outTblNameStr:=$table_name////$i:=$numOfTables//フォー文を抜ける////End if ////End if ////End for //////戻り値のテキストがからじゃなかったらポインタ取得成功//$0:=$outTblNameStrC_TEXT($1;$inTblName)$inTblName:=$1C_POINTER($0;$outTblPtr)C_TEXT($tblName)C_POINTER($tblPtr)//JCL_tbl_GetTablePointers//20110925 yabe, 20111005 wat refactor//テーブルポインタを取得C_LONGINT($numOfTables;$i)C_POINTER($table_ptr)$numOfTables:=Get last table numberFor ($i;1;$numOfTables)If (Is table number valid($i)=True)$tblPtr:=Table($i)$tblName:=Table name($i)If ($tblName=$inTblName)$outTblPtr:=$tblPtrEnd if End if End for $0:=$outTblPtr